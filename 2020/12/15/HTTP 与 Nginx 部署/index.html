<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="referrer" content="no-referrer-when-downgrade"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script>window.MSInputMethodContext&&document.documentMode&&(window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href))</script><link rel="shortcut icon" href="/images/fluidicon.png"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.13.1/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/vuetify@2.2.30/dist/vuetify.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/lb.css"><title>HTTP 与 Nginx 部署 | Rebom</title><meta name="generator" content="Hexo 5.2.0"></head><body><div id="app"><v-app><v-content id="page"><v-container fluid><v-row><v-col cols="2" class="d-none d-md-block"><div id="sidebar" class="float-right"><a href="/" rel="home"><v-avatar size="96"><img id="logo" src="/images/avatar.webp"></v-avatar></a><v-divider></v-divider><div class="mini-menu"><v-btn icon href="/"><v-icon>home</v-icon></v-btn><v-btn icon href="/categories/"><v-icon>folder</v-icon></v-btn><v-btn icon href="/tags/"><v-icon>bookmark</v-icon></v-btn><v-btn icon @click="SetNightMode"><v-icon>{{ nightMode }}</v-icon></v-btn></div><v-list id="main-menu" class="font-weight-bold" flat><v-list-item href="/archives/" link><v-list-item-icon><v-icon>archive</v-icon></v-list-item-icon><v-list-item-content>Archives</v-list-item-content></v-list-item><v-list-item href="/about/" link><v-list-item-icon><v-icon>account_circle</v-icon></v-list-item-icon><v-list-item-content>About</v-list-item-content></v-list-item><v-list-item href="https://zeuslb.github.io/index.html" link><v-list-item-icon><v-icon>rss_feed</v-icon></v-list-item-icon><v-list-item-content>我的博客</v-list-item-content></v-list-item></v-list><v-divider></v-divider><div class="post-toc"><a href="/2020/12/15/HTTP%20%E4%B8%8E%20Nginx%20%E9%83%A8%E7%BD%B2/" class="toc-header">Table of Contents</a><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80-%E7%BD%91%E7%AB%99%E6%9C%8D%E5%8A%A1%E9%80%9A%E8%AE%AF%E8%BF%87%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">一. 网站服务通讯过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C-%E7%BD%91%E7%AB%99%E6%9C%8D%E5%8A%A1%E8%B5%84%E6%BA%90%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">二. 网站服务资源类型介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89-%E7%BD%91%E7%AB%99%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE%E5%BA%A6%E9%87%8F%E6%96%B9%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">三. 网站服务访问度量方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B-%E7%BD%91%E7%AB%99%E6%9C%8D%E5%8A%A1%E5%88%9D%E8%AF%86"><span class="toc-number">4.</span> <span class="toc-text">四. 网站服务初识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94-Nginx-%E9%83%A8%E7%BD%B2"><span class="toc-number">5.</span> <span class="toc-text">五. Nginx 部署</span></a></li></ol></div></div><div id="footer"><div class="footer-social"><v-btn icon href="mailto:714616622@qq.com" target="_blank"><v-icon>fas fa-envelope</v-icon></v-btn><v-btn icon href="https://github.com/Zeuslb" target="_blank"><v-icon>fab fa-github</v-icon></v-btn></div><v-divider></v-divider><div class="footer-content"><span>&copy; 2016 - 2020 libin</span></div></div></div></v-col><v-col cols="12" md="10"><v-row><v-col cols="12" md="8" align-self="end"><div id="site-header"><div id="site-title"><a href="/" rel="home">Rebom</a></div><div id="site-description"></div><div id="mobile-menu" class="d-block d-md-none"><v-text-field label="请输入关键字" data-src="search.xml" v-model="searchHeaderValue" prepend-inner-icon="search" clearable clear-icon="clear" @keydown.enter="EnterSearch(searchHeaderValue,true)"></v-text-field><div class="mobile-mini-menu"><v-btn icon href="/"><v-icon>home</v-icon></v-btn><v-btn icon href="/categories/"><v-icon>folder</v-icon></v-btn><v-btn icon href="/tags/"><v-icon>bookmark</v-icon></v-btn><v-btn icon @click="SetNightMode"><v-icon>{{ nightMode }}</v-icon></v-btn><v-btn icon href="/archives/"><v-icon>archive</v-icon></v-btn><v-btn icon href="/about/"><v-icon>account_circle</v-icon></v-btn><v-btn icon href="https://zeuslb.github.io/index.html"><v-icon>rss_feed</v-icon></v-btn></div></div></div></v-col><v-col cols="4" align-self="end" class="d-none d-md-block"><v-col align-self="end"><v-text-field label="请输入关键字" data-src="search.xml" v-model="searchHeaderValue" prepend-icon="search" clearable clear-icon="clear" @keydown.enter="EnterSearch(searchHeaderValue,true)"></v-text-field></v-col></v-col></v-row><v-card class="elevation-2 post-card"><div class="post-header"><a class="post-header-title font-weight-medium" href="/2020/12/15/HTTP%20%E4%B8%8E%20Nginx%20%E9%83%A8%E7%BD%B2/">HTTP 与 Nginx 部署</a><div class="post-header-meta"><span><v-icon color="">event</v-icon>Posted on:&nbsp;2020-12-15 </span><span><v-icon color="">event_available</v-icon>Edited on:&nbsp;2020-12-15 </span><span><v-icon color="">folder</v-icon>In:&nbsp;<a class="category-link" href="/categories/Linux/">Linux</a> </span><span><v-icon color="">visibility</v-icon>Views:&nbsp;<span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span></span></div></div><div class="post-content typo"><h3 id="一-网站服务通讯过程"><a href="#一-网站服务通讯过程" class="headerlink" title="一. 网站服务通讯过程"></a>一. 网站服务通讯过程</h3><p><strong>网站服务通讯过程原理(简易版)</strong></p><p>首先用户在浏览器中输入域名，然后会进行DNS解析。获取到 IP 地址后，客户端和服务端通过 TCP 三次握手建立连接，然后客户端发送请求，服务端进行响应，最后会经过四次挥手断开连接。</p><p><strong>网站服务通讯过程原理/HTTP 协议请求的工作流程(描述版)</strong></p><ol><li>终端用户在 Web 浏览器地址栏输入访问地址 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 。</li><li>Web 浏览器请求 DNS 服务器把域名 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 转换为 Web 服务器的 IP 地址。</li><li>Web 浏览器将端口号（默认 80）从访问地址（URL）中解析出来。</li><li>Web 浏览器通过解析后的 IP 地址及端口号与 Web 服务器之间建立一条 TCP 连接 (三次握手)。</li><li>建立 TCP 连接后，Web 浏览器向 Web 服务器发送一条 HTTP 请求报文。</li><li>Web 服务器响应并读取浏览器的请求信息，然后返回一条 HTTP 响应报文。</li><li>Web 服务器关闭 HTTP 连接，关闭 TCP 连接，Web 浏览器显示访问的网站内容到屏幕上。</li></ol><p><strong>Windows 主机查看 DNS 的相关方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 Windows 本地缓存的 DNS 解析记录</span></span><br><span class="line">ipconfig /displaydns</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清除 Windows 本地缓存的 DNS 解析记录</span></span><br><span class="line">ipconfig /flushdns</span><br><span class="line"><span class="meta">#</span><span class="bash"> Windows 系统下 hosts 域名解析记录的位置：C:\Windows\system32\drivers\etc\hosts</span></span><br></pre></td></tr></table></figure><p><strong>DNS 概念与作用</strong></p><p>DNS，全称为 Domain Name System ，其主要作用是把网站域名解析为对应的 IP 地址。从域名到 IP 的解析过程，称作 A 记录，即 Address Record。除了 A 记录解析，DNS 还可以完成很多功能，例如：</p><ul><li>设置 CNAME 别名记录，这个别名解析功能常被 CDN 加速服务商应用。</li><li>设置 MX 邮件记录，这个 MX 记录功能，在购买或搭建邮件服务时会被用到。</li><li>设置 PTR 记录，反向解析，即把 IP 地址解析为对应的域名，和 A 记录的解析相反，此功能在邮件服务等业务中会用到。</li><li>…</li></ul><p>DNS 系统的架构类似于一颗倒挂着的树，顶点是根，用 <code>.</code> 来表示。DNS 进行域名解析时是从后往前进行解析的。</p><p><strong>DNS 解析流程</strong></p><ol><li>客户端用户在浏览器里输入 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 网站地址后回车，系统首先会查找系统本地的 DNS 缓存及 hosts 文件信息，确定是否存在 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名对应的 IP解析记录，如果有就直接获取到 IP 地址，然后去访问这个 IP 地址对应的 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名的服务器。一般第一次请求时，DNS 缓存是没有解析记录的，而 hosts 多为内部临时测试使用。</li><li>如果客户端本地 DNS 缓存及 hosts 文件没有 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名对应的解析记录，那么系统会把浏览器的解析请求发送给客户端本地设置的 DNS 服务器地址（通常称此 DNS 为 LDNS，即 Local DNS）解析，如果 LDNS 服务器的本地缓存有对应的解析记录就会直接返回 IP 地址给客户端，如果没有，则 LDNS 会负责继续请求其他的 DNS 服务器。</li><li>LDNS 从 DNS 系统的(“.”)根开始请求对 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名的解析，根 DNS 服务器在全球一共有 13 台，根服务器下面是没有 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名解析记录的，但是根下面有 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 对应的顶级域 .com 的解析记录，因此，根会把.com 对应的 DNS 服务器地址返回给 LDNS。</li><li>LDNS 获取到 .com 对应的 DNS 服务器地址后，就会去 .com 服务器请求 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名的解析，而 .com 服务器下面也没有 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名对应的解析记录，但是有 baidu.com 域名的解析记录，因此 .com 服务器会把 baidu.com 对应的 DNS 服务器地址返回给 LDNS。</li><li>同理，LDNS 获取到 baidu.com 对应的 DNS 服务器地址后，会去 baidu.com服务器请求对 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名的解析，baidu.com 域名对应的 DNS 服务器是该域名的授权 DNS 服务器，这个 DNS 服务器是企业购买域名时用于管理解析的服务器（也可能是自建的授权 DNS 服务器），这个服务器会有与 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 对应的 IP 解析记录，如果此时没有，就表示企业的域名人员没有为 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 域名做解析，即网站还没架设好。</li><li>LDNS 把来自授权 DNS 服务器的与 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 对应的 IP 解析记录发给客户端浏览器，并且 LDNS 会在本地把域名和 IP 的对应解析记录缓存起来，以便下一次更快地返回相同解析请求的记录。至此，整个 DNS 的解析流程就完成了。</li></ol><p><strong>HTTP 协议初识</strong></p><p>HTTP 协议，全称 HyperText Transfer Protocol，中文名为超文本传输协议。是互联网上常用的通信协议之一。它有很多的应用，但最流行的就是用于 Web 浏览器和 Web 服务器之间的通信，即 www 应用或称 Web 应用。</p><p>HTTP 协议属于 OSI 模型中的第七层应用层协议。</p><p>HTTP 协议的 www 服务应用的默认端口为 80，另外一个加密的 www 服务应用 HTTPS 的默认端口为 443，主要用于网银、支付等和钱相关的业务。</p><p><strong>HTTP 协议版本</strong></p><p>HTTP/0.9 是 HTTP 协议的第一个版本，仅适用于数据信息的简介交换，即仅文本传输。只接受 GET 这一种请求方式，且不支持请求头，由于不支持 POST 方式，大多数敏感信息无法交换，至此客户端无法向服务器传递过多信息。缺点是信息种类过于单一，无法满足需求，串行处理。</p><p>HTTP/1.0 支持 Cache、MIME、Method ，引入了 POST 和 HEAD 命令，在一定程度上提升了数据的传输安全，是一个典型的串行连接事务。1.0 规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个 TCP 连接，服务器完成请求处理后即断开 TCP 连接，即不支持 keepalive 。服务器不跟踪每个客户，也不记录过去的请求。缺点是串行处理，效率低下。</p><p>HTTP/1.1 是当前互联网主流的 HTTP 版本。引入了持久连接机制并被默认采用，且能更好地配合代理服务器工作，还支持管道方式同一连接下同时发送多个请求，以降低线路负载，提高传输速度。新增方法有 PUT、PATCH、OPTIONS、DELETE 。缺点是同一 TCP 连接里，所有通信按次序进行，服务器只能顺序处理回应，如果前面处理过慢，会有许多请求排队，造成队头阻塞 (Head-of-line blocking) 。</p><p>HTTP/2.0 的头信息和数据体都是二进制，称为头信息帧和数据帧。2.0 可以复用 TCP 连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，且不用按顺序一一对应，避免了”队头堵塞”，该双向的实时通信称为多工 (Multiplexing)。2.0 引入了头信息压缩机制 (header compression)，头信息使用 gzip 或 compress 压缩后再发送。2.0 也允许服务器未经请求，主动向客户端发送资源，即服务器推送 (server push) 。</p><p><strong>HTTP 请求方法</strong></p><p>在 HTTP 通信中，每个 HTTP 请求报文都包含一个方法，用以告诉 Web 服务器端需要执行哪些具体的动作。这些动作包括获取指定 Web 页面、提交内容到服务器、删除服务器上资源文件等。这些 HTTP 请求报文中包含的方法被称为 HTTP 请求方法。常见的 HTTP 请求方法见下：</p><table><thead><tr><th align="left">序号</th><th align="left">方法</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">GET</td><td align="left">获取 URI 指定的信息。如果 URI 指定的是文件，则返回文件的内容；如果 URI 指定的是 CGI 程序，则返回该程序的输出数据</td></tr><tr><td align="left">2</td><td align="left">HEAD</td><td align="left">和 GET 基本相同。不过它只返回 HTTP 的消息头 (message header) ，而并不返回数据的内容。用于获取文件最后更新时间等属性信息</td></tr><tr><td align="left">3</td><td align="left">POST</td><td align="left">从客户端向服务器发送数据。一般用于发送表单中填写的数据、上传文件等情况下</td></tr><tr><td align="left">4</td><td align="left">PUT</td><td align="left">替换 URI 指定的服务器上的文件。如果 URI 指定的文件不存在，则创建该文件</td></tr><tr><td align="left">5</td><td align="left">DELETE</td><td align="left">删除 URI 指定的服务器上的文件</td></tr><tr><td align="left">6</td><td align="left">CONNECT</td><td align="left">使用代理传输加密消息时使用的方法</td></tr><tr><td align="left">7</td><td align="left">OPTIONS</td><td align="left">允许客户端查看服务器的性能或者用于通知或查询通信选项</td></tr><tr><td align="left">8</td><td align="left">TRACE</td><td align="left">将服务器收到的请求行和头部 (header) 直接返回给客户端。用于在使用代理的环境中检查改写请求的情况 (即多用于测试)</td></tr><tr><td align="left">9</td><td align="left">PATCH</td><td align="left">是对 PUT 方法的补充，用来对已知资源进行局部更新</td></tr></tbody></table><p><strong>HTTP 状态码</strong></p><p>HTTP 状态码 (HTTP Status Code) 是用来表示 Web 服务器响应 HTTP 请求状态的数字代码。每当 Web 客户端向 Web 服务器发送一个 HTTP 请求时，Web 服务器都会返回一个状态响应代码。这个状态码是一个三位数字代码，作用是告知 Web 客户端此次请求是否成功，或者是否要采取其他的动作方式。</p><p>常见的状态码分类见下：</p><table><thead><tr><th align="left">分类</th><th align="left">分类描述</th></tr></thead><tbody><tr><td align="left">1**</td><td align="left">信息，服务器收到请求，需要请求者继续执行操作</td></tr><tr><td align="left">2**</td><td align="left">成功，操作被成功接收并处理</td></tr><tr><td align="left">3**</td><td align="left">重定向，需要进一步的操作以完成请求</td></tr><tr><td align="left">4**</td><td align="left">客户端错误，请求包含语法错误或无法完成请求</td></tr><tr><td align="left">5**</td><td align="left">服务器错误，服务器在处理请求的过程中发生了错误</td></tr></tbody></table><p>状态码速查见下：</p><table><thead><tr><th align="left">状态码</th><th align="left">状态码英文名称</th><th align="left">中文描述</th></tr></thead><tbody><tr><td align="left">100</td><td align="left">Continue</td><td align="left">继续。客户端应继续其请求</td></tr><tr><td align="left">101</td><td align="left">Switching Protocols</td><td align="left">切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议</td></tr><tr><td align="left"><code>200</code></td><td align="left">OK</td><td align="left">请求成功。一般用于GET与POST请求</td></tr><tr><td align="left">201</td><td align="left">Created</td><td align="left">已创建。成功请求并创建了新的资源</td></tr><tr><td align="left">202</td><td align="left">Accepted</td><td align="left">已接受。已经接受请求，但未处理完成</td></tr><tr><td align="left">203</td><td align="left">Non-Authoritative Information</td><td align="left">非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本</td></tr><tr><td align="left">204</td><td align="left">No Content</td><td align="left">无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档</td></tr><tr><td align="left">205</td><td align="left">Reset Content</td><td align="left">重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域</td></tr><tr><td align="left">206</td><td align="left">Partial Content</td><td align="left">部分内容。服务器成功处理了部分GET请求</td></tr><tr><td align="left">300</td><td align="left">Multiple Choices</td><td align="left">多种选择。请求的资源可包括多个位置，相应可返回一个资源特征与地址的列表用于用户终端（例如：浏览器）选择</td></tr><tr><td align="left"><code>301</code></td><td align="left">Moved Permanently</td><td align="left">永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替</td></tr><tr><td align="left"><code>302</code></td><td align="left">Found</td><td align="left">临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td></tr><tr><td align="left">303</td><td align="left">See Other</td><td align="left">查看其它地址。与301类似。使用GET和POST请求查看</td></tr><tr><td align="left">304</td><td align="left">Not Modified</td><td align="left">未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源</td></tr><tr><td align="left">305</td><td align="left">Use Proxy</td><td align="left">使用代理。所请求的资源必须通过代理访问</td></tr><tr><td align="left">306</td><td align="left">Unused</td><td align="left">已经被废弃的HTTP状态码</td></tr><tr><td align="left"><code>307</code></td><td align="left">Temporary Redirect</td><td align="left">临时重定向。与302类似。使用GET请求重定向</td></tr><tr><td align="left">400</td><td align="left">Bad Request</td><td align="left">客户端请求的语法错误，服务器无法理解</td></tr><tr><td align="left">401</td><td align="left">Unauthorized</td><td align="left">请求要求用户的身份认证</td></tr><tr><td align="left">402</td><td align="left">Payment Required</td><td align="left">保留，将来使用</td></tr><tr><td align="left">403</td><td align="left">Forbidden</td><td align="left">服务器理解请求客户端的请求，但是拒绝执行此请求</td></tr><tr><td align="left"><code>404</code></td><td align="left">Not Found</td><td align="left">服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置”您所请求的资源无法找到”的个性页面</td></tr><tr><td align="left">405</td><td align="left">Method Not Allowed</td><td align="left">客户端请求中的方法被禁止</td></tr><tr><td align="left">406</td><td align="left">Not Acceptable</td><td align="left">服务器无法根据客户端请求的内容特性完成请求</td></tr><tr><td align="left">407</td><td align="left">Proxy Authentication Required</td><td align="left">请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td></tr><tr><td align="left">408</td><td align="left">Request Time-out</td><td align="left">服务器等待客户端发送的请求时间过长，超时</td></tr><tr><td align="left">409</td><td align="left">Conflict</td><td align="left">服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突</td></tr><tr><td align="left">410</td><td align="left">Gone</td><td align="left">客户端请求的资源已经不存在。410不同于404，如果资源以前有现在被永久删除了可使用410代码，网站设计人员可通过301代码指定资源的新位置</td></tr><tr><td align="left">411</td><td align="left">Length Required</td><td align="left">服务器无法处理客户端发送的不带Content-Length的请求信息</td></tr><tr><td align="left">412</td><td align="left">Precondition Failed</td><td align="left">客户端请求信息的先决条件错误</td></tr><tr><td align="left">413</td><td align="left">Request Entity Too Large</td><td align="left">由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个Retry-After的响应信息</td></tr><tr><td align="left">414</td><td align="left">Request-URI Too Large</td><td align="left">请求的URI过长（URI通常为网址），服务器无法处理</td></tr><tr><td align="left">415</td><td align="left">Unsupported Media Type</td><td align="left">服务器无法处理请求附带的媒体格式</td></tr><tr><td align="left">416</td><td align="left">Requested range not satisfiable</td><td align="left">客户端请求的范围无效</td></tr><tr><td align="left">417</td><td align="left">Expectation Failed</td><td align="left">服务器无法满足Expect的请求头信息</td></tr><tr><td align="left"><code>500</code></td><td align="left">Internal Server Error</td><td align="left">服务器内部错误，无法完成请求</td></tr><tr><td align="left">501</td><td align="left">Not Implemented</td><td align="left">服务器不支持请求的功能，无法完成请求</td></tr><tr><td align="left">502</td><td align="left">Bad Gateway</td><td align="left">作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应</td></tr><tr><td align="left">503</td><td align="left">Service Unavailable</td><td align="left">由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的Retry-After头信息中</td></tr><tr><td align="left">504</td><td align="left">Gateway Time-out</td><td align="left">充当网关或代理的服务器，未及时从远端服务器获取请求</td></tr><tr><td align="left">505</td><td align="left">HTTP Version not supported</td><td align="left">服务器不支持请求的HTTP协议的版本，无法完成处理</td></tr></tbody></table><p><strong>生产场景常见的状态码及其对应的作用</strong></p><table><thead><tr><th>状态代码</th><th>详细描述说明</th></tr></thead><tbody><tr><td>200 - OK</td><td>服务器成功返回网页，这是成功的 HTTP 请求返回的标准状态码</td></tr><tr><td>301 - Moved Permanently</td><td>永久跳转，所请求的网页将永久跳转到被设定的新位置，例如：从 <code>zeus.com</code> 跳转到 <code>www.linus.com</code></td></tr><tr><td>403 - Forbidden</td><td>禁止访问，虽然这个请求是合法的，但是服务器端因为匹配了预先设置的规则而拒绝响应客户端的请求，此类问题一般为服务器或服务权限配置不当所致。Nginx 403 forbidden 多种原因及故障模拟重现 (<a target="_blank" rel="noopener" href="https://blog.51cto.com/oldboy/1633952)%E3%80%81apache">https://blog.51cto.com/oldboy/1633952)、apache</a> 服务 Forbidden 403 问题精彩总结 (<a target="_blank" rel="noopener" href="https://blog.51cto.com/oldboy/581383">https://blog.51cto.com/oldboy/581383</a>)</td></tr><tr><td>404 - Not Found</td><td>服务器找不到客户端请求的指定页面，可能是客户端请求了服务器上不存在的资源所致。</td></tr><tr><td>500 - Internal Server Error</td><td>内部服务器错误，服务器遇到了意料不到的情况，不能完成客户的请求。这是一个较为笼统的报错，一般为服务器的设置或内部程序问题导致。例如：SELinux 开启，而又没有为 HTTP 设置规则许可，客户端访问就是 500</td></tr><tr><td>502 - Bad Gateway</td><td>坏的网关，一般是代理服务器请求后端服务时，后端服务不可用或没有完成响应网关服务器。这通常为反向代理服务器下面的节点出问题所致。反向代理服务器无法与后面的 web 服务节点服务器建立联系</td></tr><tr><td>503 - Service Unavailable</td><td>服务当前不可用，可能是服务器超载或停机维护导致的，或者是反向代理服务器后面没有可以提供服务的节点</td></tr><tr><td>504 - Gateway Timeout</td><td>网关超时，一般是网关代理服务器请求后端服务时，后端服务没有在特定的时间内完成处理请求。多数是服务器过载导致没有在指定的时间内返回数据给前端代理服务器。</td></tr></tbody></table><p><strong>HTTP 请求报文结构</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 模拟发送请求，查看请求与响应数据包</span></span><br><span class="line">curl -v www.jd.com # 利用 curl 命令的-v 参数，查看访问网站请求与响应信息</span><br><span class="line">wget --debug www.baidu.com # 利用 wget 命令的--debug 参数，查看访问网站请求与响应信息</span><br></pre></td></tr></table></figure><p>从 Web 客户端发往 Web 服务器的 HTTP 报文，称为请求报文 (Request Message) 。HTTP 请求报文由请求行、请求头部（header）、空行和请求报文主体几个部分组成。</p><p>HTTP 请求报文格式说明见下：</p><table><thead><tr><th>报文格式</th><th>报文信息</th></tr></thead><tbody><tr><td>请求行</td><td>请求方法 URL 协议版本</td></tr><tr><td>请求头</td><td>格式 → 字段名 1 : 值 1 ，主要包含一些客户端的信息说明</td></tr><tr><td>空行</td><td>空白无内容，隔离上下行，说明请求头部结束</td></tr><tr><td>请求报文主体</td><td>GET 方法没有请求报文主体，POST 方法才有</td></tr></tbody></table><p>请求行：请求报文的第一行，用来说明客户端想要做什么。内容有请求方法字段、URL 字段和 HTTP 协议版本字段组成，它们之间用空格分隔。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br></pre></td></tr></table></figure><p>第一个部分为请求方法字段，常见的有 GET 和 POST 。</p><p>第二个部分为 URL 字段，当有具体的请求时会包含具体的请求信息，如果没有具体请求信息时，默认首页信息作响应，即 / 。</p><p>第三个部分为 HTTP 协议版本字段，此处可能为不同的版本，主要有 HTTP1.0、HTTP1.1、HTTP2.0 版本。</p><p>请求头：请求头部由关键字/值对组成，每行一对，关键字和值用英文冒号 <code>:</code> 分隔。请求头部的作用是通过客户端把请求的相关信息告诉给服务器。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Accept：image&#x2F;gif,image&#x2F;jpeg # 媒体类型</span><br><span class="line">Accept-Language：zh-cn # 语言类型</span><br><span class="line">Accept-Encoding：gzip,deflate # 支持压缩</span><br><span class="line">User-Agent：Mozilla&#x2F;4.0(compatible;MSIE6.0;Windows NT;...) # 客户端类型</span><br><span class="line">Host: https:&#x2F;&#x2F;zeuslb.github.io&#x2F; # 访问网站的目标地址</span><br></pre></td></tr></table></figure><p>最后一个请求头部信息之后是一个空行，通过发送回车符和换行符，通知 Web 服务器空行以下不会有请求头部的信息了。</p><p>请求报文主体包含了要发送给 Web 服务器的数据信息。请求报文主体不会应用于 HTTP 的 GET 命令方法，而是应用与 POST 方法。POST 方法适用于需要客户填写表单的场合。</p><p><strong>HTTP 响应数据包结构</strong></p><p>HTTP 响应报文由起始行、响应头部（header）、空行和相应报文主体这几个部分组成。</p><p>HTTP 响应报文格式说明见下：</p><table><thead><tr><th>报文格式</th><th>报文信息</th></tr></thead><tbody><tr><td>起始行</td><td>协议及版本号、数字状态码、状态信息</td></tr><tr><td>响应头部</td><td>字段名 1：值 1</td></tr><tr><td>空行</td><td>空白无内容，隔离上下文，说明响应头部结束</td></tr><tr><td>响应报文主体</td><td>请求后服务端响应返回的数据</td></tr></tbody></table><p>起始行：相应报文的起始行也叫状态行，用来说明服务器响应客户端请求的状况。一般为协议及版本号、数字状态码、状态情况。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br></pre></td></tr></table></figure><p>响应头部：和请求报文类似，起始行的后面一般有若干个头部字段。每个头部字段都包含一个名字和一个值，两者之间用冒号分隔，头部结尾也是一个空行结束的。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Server: Tengine # 告知客户端服务端使用web程序</span><br><span class="line">Content-Type: text/html # 文档的 MIME 类型</span><br><span class="line">Content-Length: 154 # 响应数据的字节大小</span><br><span class="line">Connection: keep-alive # 使用 TCP 长链接方式进行通讯</span><br><span class="line">Date: Tue, 15 Dec 2020 01:46:59 GMT # 日期</span><br><span class="line">Location: https://zeuslb.github.io/ # 指定跳转后的地址信息</span><br></pre></td></tr></table></figure><p>最后一个响应头部信息之后是一个空行，通过发送回车符和换行符，通知客户端空行下文无头部信息了。</p><p>响应报文主体：响应报文主体中装载了要返回给客户端的数据。这些数据可以是文本，也可以是二进制的（如图<br>片、视频）。</p><h3 id="二-网站服务资源类型介绍"><a href="#二-网站服务资源类型介绍" class="headerlink" title="二. 网站服务资源类型介绍"></a>二. 网站服务资源类型介绍</h3><h3 id="三-网站服务访问度量方式"><a href="#三-网站服务访问度量方式" class="headerlink" title="三. 网站服务访问度量方式"></a>三. 网站服务访问度量方式</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /var/log/nginx/access.log</span><br><span class="line">uniq xxx # 对上下内容进行去重，与 sort 结合使用即可实现去重</span><br><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /var/log/nginx/access.log | sort | uniq -c # 去重显示每个重复次数</span><br><span class="line">awk &#x27;&#123;print $1&#125;&#x27; /var/log/nginx/access.log | sort | uniq | wc -l # 显示总的数量</span><br></pre></td></tr></table></figure><h3 id="四-网站服务初识"><a href="#四-网站服务初识" class="headerlink" title="四. 网站服务初识"></a>四. 网站服务初识</h3><h3 id="五-Nginx-部署"><a href="#五-Nginx-部署" class="headerlink" title="五. Nginx 部署"></a>五. Nginx 部署</h3><p><strong>部署方式一：官方源安装</strong></p><p>使用官方源安装的目录结构会比较标准，同时可以下载最新的稳定版。</p><ol><li><p>更新 yum 下载源(nginx 官方网站：nginx.org)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 官方参考 http://nginx.org/en/linux_packages.html<span class="comment">#RHEL-CentOS</span></span></span><br><span class="line">vim /etc/yum.repos.d/nginx.repo</span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br></pre></td></tr></table></figure></li><li><p>下载安装软件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nginx</span><br><span class="line">nginx -V</span><br></pre></td></tr></table></figure></li></ol><p><strong>部署方式二：编译安装</strong></p><ol><li><p>解决依赖问题</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y pcre-devel openssl-devel</span><br><span class="line"><span class="meta">#</span><span class="bash"> pcre-devel 可以实现兼容 perl 语言的正则表达式</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> openssl-devel 可以实现基于 HTTPS 协议的数据传输</span></span><br></pre></td></tr></table></figure></li><li><p>创建服务进程管理用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd nginx -M -s /sbin/nologin</span><br></pre></td></tr></table></figure></li><li><p>下载编译安装源码包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://nginx.org/download/nginx-1.18.0.tar.gz</span><br><span class="line">tar xf nginx-1.18.0.tar.gz</span><br><span class="line">cd nginx-1.18.0</span><br></pre></td></tr></table></figure></li><li><p>编译安装</p><ul><li><p>配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">./configure --help</span><br><span class="line"><span class="meta">#</span><span class="bash"> 常见参数说明</span></span><br><span class="line">--prefix=PATH # 指定软件程序的安装路径 /app/nginx-1.18.0</span><br><span class="line">--sbin-path=PATH # 软件有关命令文件的保存路径 /usr/bin</span><br><span class="line">--modules-path=PATH # 软件生成的模块保存路径</span><br><span class="line">--conf-PATH # 软件配置文件保存路径</span><br><span class="line">--error</span><br><span class="line">--with-xxx # 可以使用的功能模块</span><br><span class="line">--without-xxx # 指定不使用的功能模块</span><br><span class="line">./configure  --prefix=/app/nginx-1.18 --user=nginx --group=nginx  --with-http_ssl_module  --with-http_stub_status_module</span><br></pre></td></tr></table></figure></li><li><p>编译</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make</span><br></pre></td></tr></table></figure></li><li><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure></li></ul></li></ol></div><div style="text-align:center;color:#ccc;font-size:16px;word-spacing:6px">--- 菩提本无树，明镜亦非台，本来无一物，何处染尘埃？ <i class="fas fa-heart"></i> The End ---</div><v-divider></v-divider><div class="post-nav"><div class="post-nav-button float-right"><a class="font-weight-bold text-right" href="/2020/12/14/NFS%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/">NFS 服务部署</a><v-icon>chevron_right</v-icon></div></div></v-card><div id="mobile-footer" class="d-block d-md-none"><v-divider></v-divider><div id="mobile-footer-content"><span>&copy; 2016 - 2020 libin</span></div></div></v-col></v-row></v-container></v-content></v-app></div><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="https://cdn.jsdelivr.net/npm/vuetify@2.2.30"></script><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-base64@3.5.2/base64.min.js"></script><script src="https://g.csdnimg.cn/??lib/jquery/1.12.4/jquery.min.js"></script><script src="/js/main.js"></script><script async src="/js/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:!0,theme:"default"})</script><script src="/js/lb.js"></script><script type="text/javascript" src="\js\snow.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/hibiki.model.json"},display:{position:"right",width:145,height:315},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.8},log:!1})</script></body></html>